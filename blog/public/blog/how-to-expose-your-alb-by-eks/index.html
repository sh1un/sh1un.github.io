<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta
  name="viewport"
  content="width=device-width, initial-scale=1, shrink-to-fit=no"
/>
<meta name="robots" content="index, follow" />
<title>
  How to Expose Your ALB by EKS | Shiun
</title>
<meta
  name="keywords"
  content="ALB, EKS, Kubernetes"
/> <meta name="description" content="å¦‚ä½•ä½¿ç”¨ ALB æš´éœ²ä½ çš„ EKS"> <meta name="author" content=""> <link rel="canonical" href="https://shiun.me/blog/how-to-expose-your-alb-by-eks/">
<link
  crossorigin="anonymous"
  href="/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css"
  integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z&#43;V9&#43;cO1A="
  rel="preload stylesheet"
  as="style"
/> <link rel="icon" href="https://github.com/sh1un/sh1un.github.io/assets/85695943/12a1e84f-ed17-4e38-8165-f67783c7f047"> <link
rel="icon" type="image/png" sizes="16x16" href="https://shiun.me/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://shiun.me/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://shiun.me/apple-touch-icon.png"> <link rel="mask-icon" href="https://shiun.me/safari-pinned-tab.svg"> <meta name="theme-color" content="#2e2e33"> <meta name="msapplication-TileColor" content="#2e2e33"> <link rel="alternate" hreflang="en" href="https://shiun.me/blog/how-to-expose-your-alb-by-eks/" />


      <script async src="https://www.googletagmanager.com/gtag/js?id=G-RZR8D4ERKG"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-RZR8D4ERKG');
        }
      </script>


<meta property="og:url" content="https://shiun.me/blog/how-to-expose-your-alb-by-eks/">
  <meta property="og:site_name" content="Shiun">
  <meta property="og:title" content="How to Expose Your ALB by EKS">
  <meta property="og:description" content="å¦‚ä½•ä½¿ç”¨ ALB æš´éœ²ä½ çš„ EKS">
  <meta property="og:locale" content="zh_tw">
  <meta property="og:type" content="article">
    <meta property="article:section" content="blog">
    <meta property="article:published_time" content="2025-05-19T20:09:29+08:00">
    <meta property="article:modified_time" content="2025-05-19T20:09:29+08:00">
    <meta property="article:tag" content="AWS">
    <meta property="article:tag" content="Kubernetes">
    <meta property="og:image" content="https://github.com/sh1un/sh1un.github.io/assets/85695943/42e903b9-06db-4cd8-b937-590a3cb26aea">




  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://github.com/sh1un/sh1un.github.io/assets/85695943/42e903b9-06db-4cd8-b937-590a3cb26aea">
  <meta name="twitter:title" content="How to Expose Your ALB by EKS">
  <meta name="twitter:description" content="å¦‚ä½•ä½¿ç”¨ ALB æš´éœ²ä½ çš„ EKS">


<noscript>
  <style>
    #theme-toggle,
    .top-link {
      display: none;
    }
  </style>
  <style>
    @media (prefers-color-scheme: dark) {
      :root {
        --theme: rgb(29, 30, 32);
        --entry: rgb(46, 46, 51);
        --primary: rgb(218, 218, 219);
        --secondary: rgb(155, 156, 157);
        --tertiary: rgb(65, 66, 68);
        --content: rgb(196, 196, 197);
        --code-block-bg: rgb(46, 46, 51);
        --code-bg: rgb(55, 56, 62);
        --border: rgb(51, 51, 51);
      }

      .list {
        background: var(--theme);
      }

      .list:not(.dark)::-webkit-scrollbar-track {
        background: 0 0;
      }

      .list:not(.dark)::-webkit-scrollbar-thumb {
        border-color: var(--theme);
      }
    }
  </style>
</noscript>
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-RZR8D4ERKG"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-RZR8D4ERKG');
        }
      </script><meta property="og:title" content="How to Expose Your ALB by EKS" />
<meta property="og:description" content="å¦‚ä½•ä½¿ç”¨ ALB æš´éœ²ä½ çš„ EKS" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://shiun.me/blog/how-to-expose-your-alb-by-eks/" /><meta property="og:image" content="https://github.com/sh1un/sh1un.github.io/assets/85695943/42e903b9-06db-4cd8-b937-590a3cb26aea"/><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2025-05-19T20:09:29+08:00" />
<meta property="article:modified_time" content="2025-05-19T20:09:29+08:00" /><meta property="og:site_name" content="Shiun&#39;s Blog" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://github.com/sh1un/sh1un.github.io/assets/85695943/42e903b9-06db-4cd8-b937-590a3cb26aea"/>

<meta name="twitter:title" content="How to Expose Your ALB by EKS"/>
<meta name="twitter:description" content="å¦‚ä½•ä½¿ç”¨ ALB æš´éœ²ä½ çš„ EKS"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Blogs",
      "item": "https://shiun.me/blog/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "How to Expose Your ALB by EKS",
      "item": "https://shiun.me/blog/how-to-expose-your-alb-by-eks/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "How to Expose Your ALB by EKS",
  "name": "How to Expose Your ALB by EKS",
  "description": "å¦‚ä½•ä½¿ç”¨ ALB æš´éœ²ä½ çš„ EKS",
  "keywords": [
    "ALB", "EKS", "Kubernetes"
  ],
  "articleBody": "å¦‚ä½•ä½¿ç”¨ ALB æš´éœ²ä½ çš„ EKS Tags: AWS ALB, AWS EKS, AWS ELB, Kubernetes Category: AWS, Kubernetes Created time: March 17, 2025 4:17 PM Last edited time: March 18, 2025 10:22 AM\naws-load-balancer-controller 1.11.0 Â· helm/aws\nRoute application and HTTP traffic with Application Load Balancers - Amazon EKS\nWhen you create a KubernetesÂ ingress, an AWS Application Load Balancer (ALB) is provisioned that load balances application traffic.\nQ\u0026A AWS Load Balancer Controller æœƒä»¥ä»€éº¼æ¨£çš„å½¢å¼å­˜åœ¨åœ¨ K8s Cluster?\nClaude 3.7 Sonnet\nAWS Load Balancer Controller åœ¨ Kubernetes (K8s) å¢é›†ä¸­æ˜¯ä»¥ Deployment çš„å½¢å¼å­˜åœ¨ï¼Œå…·é«”ä¾†èªªå®ƒæœ‰ä»¥ä¸‹ç‰¹é»ï¼š\nå®ƒä½œç‚ºä¸€å€‹ Deployment è³‡æºéƒ¨ç½²åœ¨ K8s å¢é›†ä¸­ é€šå¸¸éƒ¨ç½²åœ¨ kube-system æˆ–å°ˆé–€çš„å‘½åç©ºé–“ï¼ˆå¦‚ aws-load-balancer-controllerï¼‰ ä»¥ Pod çš„å½¢å¼é‹è¡Œï¼ŒPod å…§åŒ…å« AWS Load Balancer Controller çš„å®¹å™¨ ä½¿ç”¨ ServiceAccount èˆ‡ç›¸æ‡‰çš„ RBAC æ¬Šé™ä¾†ç®¡ç† K8s è³‡æº ç›£è½ç‰¹å®šçš„ K8s è³‡æºï¼ˆå¦‚ Ingress, Serviceï¼‰ä¸¦è‡ªå‹•åœ¨ AWS ä¸­å‰µå»ºå’Œé…ç½®ç›¸æ‡‰çš„è² è¼‰å‡è¡¡å™¨ AWS Load Balancer Controller çš„ä¸»è¦åŠŸèƒ½æ˜¯ç›£è½ Kubernetes ä¸­çš„è®ŠåŒ–ï¼Œç‰¹åˆ¥æ˜¯ Ingress å’Œ Service é¡å‹ç‚º LoadBalancer çš„è³‡æºï¼Œç„¶å¾Œåœ¨ AWS ä¸­è‡ªå‹•å‰µå»ºå’Œé…ç½®ç›¸æ‡‰çš„ Application Load Balancer (ALB) æˆ– Network Load Balancer (NLB)ï¼Œç¢ºä¿å¤–éƒ¨æµé‡èƒ½å¤ æ­£ç¢ºè·¯ç”±åˆ° K8s å¢é›†ä¸­çš„æ‡‰ç”¨ã€‚\nalb.ingress.kubernetes.io/healthcheck-path: è€å¯¦èªªæˆ‘ä¸çŸ¥é“ Nginx çš„å¥åº·æª¢æŸ¥è·¯å¾‘\nClaude 3.7 Sonnet\nå°æ–¼ Nginxï¼Œé è¨­çš„å¥åº·æª¢æŸ¥è·¯å¾‘å¯ä»¥ç®€å•è®¾ä¸º /ï¼Œä½†è¿™å¯èƒ½æœƒå°è‡´æ¯æ¬¡å¥åº·æª¢æŸ¥éƒ½è¼‰å…¥å®Œæ•´é é¢ï¼Œé€™ä¸¦ä¸æ˜¯æœ€ç†æƒ³çš„æ–¹æ³•ã€‚\næ›´å¥½çš„åšæ³•æ˜¯åœ¨ä½ çš„ Nginx é…ç½®ä¸­å‰µå»ºä¸€å€‹å°ˆé–€ç”¨æ–¼å¥åº·æª¢æŸ¥çš„è¼•é‡ç´šç«¯é»ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥åœ¨ Nginx é…ç½®ä¸­æ·»åŠ ï¼š\nlocation /health { access_log off; return 200 \"healthy\\n\"; } ç„¶å¾Œåœ¨ Ingress ä¸­è¨­ç½®:\nalb.ingress.kubernetes.io/healthcheck-path: /health é€™æ¨£ AWS ALB å°±æœƒæª¢æŸ¥é€™å€‹è¼•é‡ç´šè·¯å¾‘ï¼Œè€Œä¸æœƒåŠ é‡ä½ çš„æ‡‰ç”¨è² æ“”ã€‚\nå¦‚æœä½ ä½¿ç”¨çš„æ˜¯æ¨™æº–çš„ Nginx æ˜ åƒè€Œæ²’æœ‰è‡ªå®šç¾©é…ç½®ï¼Œé‚£éº¼ä½¿ç”¨ / è·¯å¾‘æ‡‰è©²å¯ä»¥å·¥ä½œï¼Œä½†æ•ˆç‡ä¸æ˜¯æœ€ä½³ã€‚ALB å¥åº·æª¢æŸ¥æœƒå‘é€™å€‹è·¯å¾‘ç™¼é€è«‹æ±‚ï¼Œå¦‚æœæ”¶åˆ° 2xx æˆ– 3xx éŸ¿æ‡‰ç¢¼ï¼Œå°±æœƒèªç‚ºæœå‹™æ˜¯å¥åº·çš„ã€‚\næ³¨æ„ï¼šå¦‚æœä½ çš„ Nginx è¨­ç½®äº†è¤‡é›œçš„è·¯ç”±æˆ–èªè­‰ï¼Œç¢ºä¿å¥åº·æª¢æŸ¥è·¯å¾‘æ˜¯å¯ä»¥ç„¡èªè­‰è¨ªå•çš„ï¼Œå¦å‰‡å¥åº·æª¢æŸ¥æœƒå¤±æ•—ã€‚\næˆ‘å¾ˆå¥½å¥‡ï¼Œæˆ‘åœ¨ ingress é‚£é‚Šå‘€æ ¹æœ¬æ²’æŒ‡å®šä»€éº¼ regionï¼Œé‚£ kubectl apply -f ingress.yaml å¾Œï¼Œk8s æ€é‚£éº¼è°æ˜çŸ¥é“è¦å»ºç«‹ ALB åœ¨å“ªå€‹ AWS Region?\nClaude 3.7 Sonnt é€™æ˜¯å€‹å¾ˆå¥½çš„å•é¡Œï¼Kubernetes æœ¬èº«ä¸¦ä¸çŸ¥é“è¦åœ¨å“ªå€‹ AWS å€åŸŸå»ºç«‹ ALBï¼Œé€™å€‹é‚è¼¯æ˜¯ç”± AWS Load Balancer Controller è™•ç†çš„ã€‚é€™è£¡æ˜¯å®ƒå¦‚ä½•å·¥ä½œçš„ï¼š\nç•¶ä½ éƒ¨ç½² AWS Load Balancer Controller åˆ°ä½ çš„ Kubernetes å¢é›†æ™‚ï¼Œä½ éœ€è¦ç‚ºå®ƒæä¾› AWS æ†‘è­‰å’Œé…ç½®ã€‚Controller æœƒåœ¨å•Ÿå‹•æ™‚ç¢ºå®šå®ƒéœ€è¦æ“ä½œçš„ AWS å€åŸŸï¼Œé€šå¸¸æ˜¯é€šéä»¥ä¸‹å¹¾ç¨®æ–¹å¼ä¹‹ä¸€ï¼š\nå¾ EC2 å¯¦ä¾‹å…ƒæ•¸æ“šç²å–ï¼šå¦‚æœä½ çš„ Kubernetes å¢é›†é‹è¡Œåœ¨ EKS æˆ–è‡ªç®¡ç†çš„ EC2 å¯¦ä¾‹ä¸Šï¼ŒController æœƒä½¿ç”¨ EC2 å¯¦ä¾‹å…ƒæ•¸æ“šæœå‹™ä¾†ç¢ºå®šç•¶å‰çš„ AWS å€åŸŸã€‚ å¾ç’°å¢ƒè®Šæ•¸ç²å–ï¼šéƒ¨ç½² Controller æ™‚å¯èƒ½è¨­ç½®äº† AWS_REGION æˆ– AWS_DEFAULT_REGION ç’°å¢ƒè®Šæ•¸ã€‚ å¾ AWS SDK é…ç½®ç²å–ï¼šController ä½¿ç”¨ AWS SDKï¼Œå¯èƒ½æœƒå¾ ~/.aws/config æˆ–å…¶ä»– AWS é…ç½®ä¾†æºç²å–å€åŸŸä¿¡æ¯ã€‚ å¾ Controller çš„éƒ¨ç½²é…ç½®ç²å–ï¼šåœ¨ Helm chart æˆ– YAML éƒ¨ç½²æ–‡ä»¶ä¸­ï¼Œå¯èƒ½æœƒæ˜ç¢ºè¨­ç½® AWS å€åŸŸã€‚ åŸºæœ¬åŸå‰‡æ˜¯ï¼šAWS Load Balancer Controller æœƒåœ¨éƒ¨ç½²å’Œé…ç½®æ™‚å·²ç¶“çŸ¥é“å®ƒæ‡‰è©²æ“ä½œå“ªå€‹ AWS å€åŸŸï¼Œé€™æ¨£ç•¶ä½ æ‡‰ç”¨ Ingress è³‡æºæ™‚ï¼Œå®ƒå°±å·²ç¶“çŸ¥é“æ‡‰è©²åœ¨å“ªå€‹å€åŸŸå‰µå»º ALBã€‚\né€™æ­£æ˜¯ Kubernetes é‹ç‡Ÿå•†æ¨¡å¼ï¼ˆOperator Patternï¼‰çš„é­…åŠ›æ‰€åœ¨ - ä½ åªéœ€è¦è²æ˜ä½ æƒ³è¦ä»€éº¼ï¼ˆåœ¨é€™å€‹ä¾‹å­ä¸­æ˜¯ä¸€å€‹ Ingress è³‡æºï¼‰ï¼Œè€Œå°ˆé–€çš„ Controller æœƒè™•ç†å¦‚ä½•åœ¨ç‰¹å®šçš„é›²ç’°å¢ƒä¸­å¯¦ç¾å®ƒçš„æ‰€æœ‰ç´°ç¯€ã€‚\nChatGPT 4o åœ¨ Kubernetes (k8s) çš„ Ingress è¨­å®šä¸­ï¼Œä½ çš„ ingress.yaml ä¸¦ä¸æœƒç›´æ¥æŒ‡å®š AWS Regionï¼Œä½† Kubernetes ä¹‹æ‰€ä»¥çŸ¥é“è©²åœ¨å“ªå€‹ AWS Region å»ºç«‹ ALB (Application Load Balancer)ï¼Œæ˜¯å› ç‚º ä½ çš„ EKS Cluster (æˆ– Kubernetes cluster) æ˜¯å»ºç«‹åœ¨æŸå€‹ AWS Region ä¸Šçš„ã€‚\nç‚ºä»€éº¼ Kubernetes çŸ¥é“è¦åœ¨å“ªå€‹ AWS Region å»ºç«‹ ALBï¼Ÿ EKS Cluster å·²ç¶“ç¶å®š AWS Region ç•¶ä½ å»ºç«‹ EKS (Amazon Elastic Kubernetes Service) Cluster æ™‚ï¼Œä½ å·²ç¶“æŒ‡å®šäº† AWS Regionã€‚ä¾‹å¦‚ï¼š\naws eks create-cluster --region us-west-2 --name my-cluster ... é€™å€‹ EKS Cluster å…§çš„æ‰€æœ‰ AWS ç›¸é—œè³‡æº (åƒæ˜¯ Load Balancer, EBS, IAM Policies) éƒ½æœƒåœ¨é€™å€‹ Region å…§å»ºç«‹ã€‚\nKubernetes é€é AWS Load Balancer Controller è‡ªå‹•æŸ¥è©¢ Region ç•¶ä½ åœ¨ kubectl apply -f ingress.yaml æ™‚ï¼ŒEKS å…§éƒ¨çš„ AWS Load Balancer Controller æœƒè‡ªå‹•è§£æè©² Ingress è³‡è¨Šï¼Œç„¶å¾Œï¼š æŸ¥è©¢è©² EKS Cluster æ‰€åœ¨çš„ AWS Region åœ¨è©² Region è‡ªå‹•å»ºç«‹å°æ‡‰çš„ ALB ä½ å¯ä»¥é€é kubectl get deployment -n kube-system aws-load-balancer-controller ç¢ºèª AWS Load Balancer Controller æ˜¯å¦æœ‰é‹è¡Œã€‚ é€é EKS Cluster çš„ IAM Role ä¾†å­˜å– AWS è³‡æº EKS Cluster æœƒä½¿ç”¨æŒ‡å®šçš„ IAM Roleï¼Œé€™å€‹ Role çš„æ¬Šé™é€šå¸¸å…è¨±å®ƒç®¡ç† ELB/ALBã€‚ ç•¶ Ingress Controller åµæ¸¬åˆ°æ–°çš„ Ingress è³‡æºæ™‚ï¼Œå®ƒæœƒä½¿ç”¨é€™å€‹ IAM Role ä¾†å‘¼å« AWS APIï¼Œåœ¨ EKS Cluster æ‰€åœ¨çš„ Region å»ºç«‹ ALBã€‚ ä½ å¯ä»¥åœ¨å“ªè£¡çœ‹åˆ° Region è¨­å®šï¼Ÿ å¦‚æœä½ æƒ³ç¢ºèªä½ çš„ Kubernetes Cluster æ˜¯åœ¨å“ªå€‹ AWS Regionï¼Œå¯ä»¥ï¼š\naws eks describe-cluster --name my-cluster --query \"cluster.resourcesVpcConfig.clusterSecurityGroupId\" --region us-west-2 æˆ–ç›´æ¥æŸ¥è©¢ Cluster çš„ Regionï¼š\nkubectl get nodes -o wide ä½ æœƒçœ‹åˆ° Node (EC2) æ˜¯åœ¨å“ªå€‹ AWS å¯ç”¨å€ (AZ)ï¼Œä¹Ÿå¯ä»¥æ¨æ–·å‡º Regionã€‚\nçµè«– ç•¶ä½  kubectl apply -f ingress.yamlï¼ŒKubernetes ä¹‹æ‰€ä»¥çŸ¥é“ ALB è¦å»ºåœ¨å“ªå€‹ Regionï¼Œæ˜¯å› ç‚ºï¼š\nEKS Cluster æœ¬èº«å·²ç¶“æ˜¯ Region-Specificï¼Œæ‰€æœ‰ AWS è³‡æºéƒ½æœƒåœ¨é€™å€‹ Region å…§å»ºç«‹ã€‚ AWS Load Balancer Controller æœƒè‡ªå‹•åµæ¸¬ EKS Cluster çš„ Regionï¼Œä¸¦åœ¨ç›¸æ‡‰çš„ Region å…§å»ºç«‹ ALBã€‚ EKS Cluster çš„ IAM Role å·²ç¶“æœ‰æ¬Šé™å­˜å–è©² Region å…§çš„ AWS è³‡æºï¼Œè®“ Controller å¯ä»¥é€é AWS API å»ºç«‹ ALBã€‚ ä½ ä¸éœ€è¦æ‰‹å‹•æŒ‡å®š Regionï¼Œå› ç‚º EKS Cluster æœ¬èº«å·²ç¶“æ±ºå®šäº†ä¸€åˆ‡ ğŸš€\nå‰æƒ…æè¦ å‰›ç¶“æ­·äº†ä¸€æ³¢è‹¦æµ· è¸©å‘ç´€éŒ„ - æ›´æ–°äº† resources requestï¼Œç„¡æ³•èª¿åº¦ pod Karpenter å’Œ Pod è¦æ€éº¼è¨­ç½®ï¼Œæ‰å¯ä»¥è®“ WorkerNode é–‹åœ¨ä¸åŒ AZï¼ŒPod é…åœ¨ä¸åŒ Node\næ¥ä¸‹ä¾†æˆ‘è¦ç”¨ ALB æš´éœ²æˆ‘çš„æ‡‰ç”¨å•¦\nå…¶å¯¦ä¹‹å‰åœ¨åš [Workshop] AmazonÂ EKSÂ Workshop - Fundamental æœ‰åšåˆ°ä¸€é»é»ï¼Œå¤§æ¦‚æœ‰å€‹åŸºæœ¬æ¦‚å¿µäº†ï¼Œä½†æ˜¯æˆ‘å¸Œæœ›æˆ‘è‡ªå·±èƒ½å¤ å»ç†è§£é€å¾¹é€™é‚Šçš„åŸç†æ·±å…¥ä¸€é»\nå®‰è£ AWS Load Banlancer Controller åˆ°é›†ç¾¤ å–è‡ª Helm TL;DR:\nhelm repo add eks https://aws.github.io/eks-charts # If using IAM Roles for service account install as follows - NOTE: you need to specify both of the chart values `serviceAccount.create=false` and `serviceAccount.name=aws-load-balancer-controller` helm install aws-load-balancer-controller eks/aws-load-balancer-controller --set clusterName=my-cluster -n kube-system --set serviceAccount.create=false --set serviceAccount.name=aws-load-balancer-controller # If not using IAM Roles for service account helm install aws-load-balancer-controller eks/aws-load-balancer-controller --set clusterName=my-cluster -n kube-system æˆ‘æ˜¯æ²’å®‰è£å•¦ï¼Œå› ç‚ºæˆ‘ç›®å‰æ‰€åœ¨ Cluster å·²ç¶“æœ‰å‰äººå®‰è£éäº†ï¼š\n$ kubectl get deploy -n kube-system | grep aws-load aws-load-balancer-controller 2/2 2 2 2y152d å»ºç«‹ Ingress é€™é‚Šæˆ‘æœƒéœ€è¦å…ˆæ‹¿åˆ° Nginx çš„ Service name\n$ kubectl get svc NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE shiun-nginx ClusterIP 172.20.235.205 80/TCP,443/TCP 3d2h ç„¶å¾Œä¾†æ’°å¯« ingress.yaml\napiVersion: networking.k8s.io/v1 kind: Ingress metadata: name: shiun-onboarding-alb namespace: shiun-onboarding annotations: alb.ingress.kubernetes.io/scheme: internet-facing alb.ingress.kubernetes.io/target-type: ip alb.ingress.kubernetes.io/healthcheck-path: / spec: ingressClassName: alb rules: - http: paths: - path: / pathType: Prefix backend: service: name: shiun-nginx port: number: 80 kubectl apply -f ingress.yaml æ¥è‘—ä¸Šå»çœ‹ ALB Consoleï¼Œå°±æœƒçœ‹åˆ°ä»–æ­£åœ¨å‰µå»ºäº†ï¼š\nç„¶å¾Œæ‹¿åˆ° ALB çš„ DNS Nameï¼Œçœ‹åˆ°ç•«é¢ï¼ï¼\n",
  "wordCount" : "719",
  "inLanguage": "en",
  "datePublished": "2025-05-19T20:09:29+08:00",
  "dateModified": "2025-05-19T20:09:29+08:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://shiun.me/blog/how-to-expose-your-alb-by-eks/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Shiun",
    "logo": {
      "@type": "ImageObject",
      "url": "https://github.com/sh1un/sh1un.github.io/assets/85695943/12a1e84f-ed17-4e38-8165-f67783c7f047"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://shiun.me/" accesskey="h" title="Shiun (Alt + H)">Shiun</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://shiun.me/blog/" title="Blog">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="https://shiun.me/archives/" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
            <li>
                <a href="https://shiun.me/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://shiun.me/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://shiun.notion.site/Shiun-s-Learning-Journal-ded4cd4a3efd47b2805f2f99dee8f9a1?pvs=4" title="Notion">
                    <span>Notion</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
            <li>
                <a href="https://www.linkedin.com/in/shiunchiu" title="About me">
                    <span>About me</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://shiun.me/">Home</a>&nbsp;Â»&nbsp;<a href="https://shiun.me/blog/">Blogs</a></div>
    <h1 class="post-title entry-hint-parent">
      How to Expose Your ALB by EKS
    </h1>
    <div class="post-description">
      å¦‚ä½•ä½¿ç”¨ ALB æš´éœ²ä½ çš„ EKS
    </div>
    <div class="post-meta"><span title='2025-05-19 20:09:29 +0800 CST'>May 19, 2025</span>&nbsp;Â·&nbsp;4 min

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8-alb-%e6%9a%b4%e9%9c%b2%e4%bd%a0%e7%9a%84-eks" aria-label="å¦‚ä½•ä½¿ç”¨ ALB æš´éœ²ä½ çš„ EKS">å¦‚ä½•ä½¿ç”¨ ALB æš´éœ²ä½ çš„ EKS</a><ul>
                        
                <li>
                    <a href="#qa" aria-label="Q&amp;A">Q&amp;A</a></li></ul>
                </li>
                <li>
                    <a href="#claude-37-sonnt" aria-label="Claude 3.7 Sonnt">Claude 3.7 Sonnt</a></li>
                <li>
                    <a href="#chatgpt-4o" aria-label="ChatGPT 4o">ChatGPT 4o</a><ul>
                        <ul>
                        
                <li>
                    <a href="#%e7%82%ba%e4%bb%80%e9%ba%bc-kubernetes-%e7%9f%a5%e9%81%93%e8%a6%81%e5%9c%a8%e5%93%aa%e5%80%8b-aws-region-%e5%bb%ba%e7%ab%8b-alb" aria-label="ç‚ºä»€éº¼ Kubernetes çŸ¥é“è¦åœ¨å“ªå€‹ AWS Region å»ºç«‹ ALBï¼Ÿ">ç‚ºä»€éº¼ Kubernetes çŸ¥é“è¦åœ¨å“ªå€‹ AWS Region å»ºç«‹ ALBï¼Ÿ</a></li>
                <li>
                    <a href="#%e4%bd%a0%e5%8f%af%e4%bb%a5%e5%9c%a8%e5%93%aa%e8%a3%a1%e7%9c%8b%e5%88%b0-region-%e8%a8%ad%e5%ae%9a" aria-label="ä½ å¯ä»¥åœ¨å“ªè£¡çœ‹åˆ° Region è¨­å®šï¼Ÿ">ä½ å¯ä»¥åœ¨å“ªè£¡çœ‹åˆ° Region è¨­å®šï¼Ÿ</a></li>
                <li>
                    <a href="#%e7%b5%90%e8%ab%96" aria-label="çµè«–">çµè«–</a></li></ul>
                    
                <li>
                    <a href="#%e5%89%8d%e6%83%85%e6%8f%90%e8%a6%81" aria-label="å‰æƒ…æè¦">å‰æƒ…æè¦</a></li>
                <li>
                    <a href="#%e5%ae%89%e8%a3%9d-aws-load-banlancer-controller-%e5%88%b0%e9%9b%86%e7%be%a4" aria-label="å®‰è£ AWS Load Banlancer Controller åˆ°é›†ç¾¤">å®‰è£ AWS Load Banlancer Controller åˆ°é›†ç¾¤</a></li>
                <li>
                    <a href="#%e5%bb%ba%e7%ab%8b-ingress" aria-label="å»ºç«‹ Ingress">å»ºç«‹ Ingress</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="å¦‚ä½•ä½¿ç”¨-alb-æš´éœ²ä½ çš„-eks">å¦‚ä½•ä½¿ç”¨ ALB æš´éœ²ä½ çš„ EKS<a hidden class="anchor" aria-hidden="true" href="#å¦‚ä½•ä½¿ç”¨-alb-æš´éœ²ä½ çš„-eks">#</a></h1>
<p>Tags: AWS ALB, AWS EKS, AWS ELB, Kubernetes
Category: AWS, Kubernetes
Created time: March 17, 2025 4:17 PM
Last edited time: March 18, 2025 10:22 AM</p>
<p><a href="https://artifacthub.io/packages/helm/aws/aws-load-balancer-controller">aws-load-balancer-controller 1.11.0 Â· helm/aws</a></p>
<p><a href="https://docs.aws.amazon.com/eks/latest/userguide/alb-ingress.html">Route application and HTTP traffic with Application Load Balancers - Amazon EKS</a></p>
<blockquote>
<p>When you create a KubernetesÂ <code>ingress</code>, an AWS Application Load Balancer (ALB) is provisioned that load balances application traffic.</p>
</blockquote>
<h2 id="qa">Q&amp;A<a hidden class="anchor" aria-hidden="true" href="#qa">#</a></h2>
<ul>
<li>
<p>AWS Load Balancer Controller æœƒä»¥ä»€éº¼æ¨£çš„å½¢å¼å­˜åœ¨åœ¨ K8s Cluster?</p>
<p>Claude 3.7 Sonnet</p>
<p>AWS Load Balancer Controller åœ¨ Kubernetes (K8s) å¢é›†ä¸­æ˜¯ä»¥ Deployment çš„å½¢å¼å­˜åœ¨ï¼Œå…·é«”ä¾†èªªå®ƒæœ‰ä»¥ä¸‹ç‰¹é»ï¼š</p>
<ol>
<li>å®ƒä½œç‚ºä¸€å€‹ Deployment è³‡æºéƒ¨ç½²åœ¨ K8s å¢é›†ä¸­</li>
<li>é€šå¸¸éƒ¨ç½²åœ¨ kube-system æˆ–å°ˆé–€çš„å‘½åç©ºé–“ï¼ˆå¦‚ aws-load-balancer-controllerï¼‰</li>
<li>ä»¥ Pod çš„å½¢å¼é‹è¡Œï¼ŒPod å…§åŒ…å« AWS Load Balancer Controller çš„å®¹å™¨</li>
<li>ä½¿ç”¨ ServiceAccount èˆ‡ç›¸æ‡‰çš„ RBAC æ¬Šé™ä¾†ç®¡ç† K8s è³‡æº</li>
<li>ç›£è½ç‰¹å®šçš„ K8s è³‡æºï¼ˆå¦‚ Ingress, Serviceï¼‰ä¸¦è‡ªå‹•åœ¨ AWS ä¸­å‰µå»ºå’Œé…ç½®ç›¸æ‡‰çš„è² è¼‰å‡è¡¡å™¨</li>
</ol>
<p>AWS Load Balancer Controller çš„ä¸»è¦åŠŸèƒ½æ˜¯ç›£è½ Kubernetes ä¸­çš„è®ŠåŒ–ï¼Œç‰¹åˆ¥æ˜¯ Ingress å’Œ Service é¡å‹ç‚º LoadBalancer çš„è³‡æºï¼Œç„¶å¾Œåœ¨ AWS ä¸­è‡ªå‹•å‰µå»ºå’Œé…ç½®ç›¸æ‡‰çš„ Application Load Balancer (ALB) æˆ– Network Load Balancer (NLB)ï¼Œç¢ºä¿å¤–éƒ¨æµé‡èƒ½å¤ æ­£ç¢ºè·¯ç”±åˆ° K8s å¢é›†ä¸­çš„æ‡‰ç”¨ã€‚</p>
</li>
<li>
<p><a href="http://alb.ingress.kubernetes.io/healthcheck-path:">alb.ingress.kubernetes.io/healthcheck-path:</a> è€å¯¦èªªæˆ‘ä¸çŸ¥é“ Nginx çš„å¥åº·æª¢æŸ¥è·¯å¾‘</p>
<p>Claude 3.7 Sonnet</p>
<p>å°æ–¼ Nginxï¼Œé è¨­çš„å¥åº·æª¢æŸ¥è·¯å¾‘å¯ä»¥ç®€å•è®¾ä¸º <code>/</code>ï¼Œä½†è¿™å¯èƒ½æœƒå°è‡´æ¯æ¬¡å¥åº·æª¢æŸ¥éƒ½è¼‰å…¥å®Œæ•´é é¢ï¼Œé€™ä¸¦ä¸æ˜¯æœ€ç†æƒ³çš„æ–¹æ³•ã€‚</p>
<p>æ›´å¥½çš„åšæ³•æ˜¯åœ¨ä½ çš„ Nginx é…ç½®ä¸­å‰µå»ºä¸€å€‹å°ˆé–€ç”¨æ–¼å¥åº·æª¢æŸ¥çš„è¼•é‡ç´šç«¯é»ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥åœ¨ Nginx é…ç½®ä¸­æ·»åŠ ï¼š</p>
<pre tabindex="0"><code>location /health {
    access_log off;
    return 200 &#34;healthy\n&#34;;
}
</code></pre><p>ç„¶å¾Œåœ¨ Ingress ä¸­è¨­ç½®:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">alb.ingress.kubernetes.io/healthcheck-path</span>: <span style="color:#ae81ff">/health</span>
</span></span></code></pre></div><p>é€™æ¨£ AWS ALB å°±æœƒæª¢æŸ¥é€™å€‹è¼•é‡ç´šè·¯å¾‘ï¼Œè€Œä¸æœƒåŠ é‡ä½ çš„æ‡‰ç”¨è² æ“”ã€‚</p>
<p>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯æ¨™æº–çš„ Nginx æ˜ åƒè€Œæ²’æœ‰è‡ªå®šç¾©é…ç½®ï¼Œé‚£éº¼ä½¿ç”¨ <code>/</code> è·¯å¾‘æ‡‰è©²å¯ä»¥å·¥ä½œï¼Œä½†æ•ˆç‡ä¸æ˜¯æœ€ä½³ã€‚ALB å¥åº·æª¢æŸ¥æœƒå‘é€™å€‹è·¯å¾‘ç™¼é€è«‹æ±‚ï¼Œå¦‚æœæ”¶åˆ° 2xx æˆ– 3xx éŸ¿æ‡‰ç¢¼ï¼Œå°±æœƒèªç‚ºæœå‹™æ˜¯å¥åº·çš„ã€‚</p>
<p>æ³¨æ„ï¼šå¦‚æœä½ çš„ Nginx è¨­ç½®äº†è¤‡é›œçš„è·¯ç”±æˆ–èªè­‰ï¼Œç¢ºä¿å¥åº·æª¢æŸ¥è·¯å¾‘æ˜¯å¯ä»¥ç„¡èªè­‰è¨ªå•çš„ï¼Œå¦å‰‡å¥åº·æª¢æŸ¥æœƒå¤±æ•—ã€‚</p>
</li>
<li>
<p>æˆ‘å¾ˆå¥½å¥‡ï¼Œæˆ‘åœ¨ ingress é‚£é‚Šå‘€æ ¹æœ¬æ²’æŒ‡å®šä»€éº¼ regionï¼Œé‚£ kubectl apply -f ingress.yaml å¾Œï¼Œk8s æ€é‚£éº¼è°æ˜çŸ¥é“è¦å»ºç«‹ ALB åœ¨å“ªå€‹ AWS Region?</p>
<h1 id="claude-37-sonnt">Claude 3.7 Sonnt<a hidden class="anchor" aria-hidden="true" href="#claude-37-sonnt">#</a></h1>
<p>é€™æ˜¯å€‹å¾ˆå¥½çš„å•é¡Œï¼Kubernetes æœ¬èº«ä¸¦ä¸çŸ¥é“è¦åœ¨å“ªå€‹ AWS å€åŸŸå»ºç«‹ ALBï¼Œé€™å€‹é‚è¼¯æ˜¯ç”± AWS Load Balancer Controller è™•ç†çš„ã€‚é€™è£¡æ˜¯å®ƒå¦‚ä½•å·¥ä½œçš„ï¼š</p>
<p>ç•¶ä½ éƒ¨ç½² AWS Load Balancer Controller åˆ°ä½ çš„ Kubernetes å¢é›†æ™‚ï¼Œä½ éœ€è¦ç‚ºå®ƒæä¾› AWS æ†‘è­‰å’Œé…ç½®ã€‚Controller æœƒåœ¨å•Ÿå‹•æ™‚ç¢ºå®šå®ƒéœ€è¦æ“ä½œçš„ AWS å€åŸŸï¼Œé€šå¸¸æ˜¯é€šéä»¥ä¸‹å¹¾ç¨®æ–¹å¼ä¹‹ä¸€ï¼š</p>
<ol>
<li><strong>å¾ EC2 å¯¦ä¾‹å…ƒæ•¸æ“šç²å–</strong>ï¼šå¦‚æœä½ çš„ Kubernetes å¢é›†é‹è¡Œåœ¨ EKS æˆ–è‡ªç®¡ç†çš„ EC2 å¯¦ä¾‹ä¸Šï¼ŒController æœƒä½¿ç”¨ EC2 å¯¦ä¾‹å…ƒæ•¸æ“šæœå‹™ä¾†ç¢ºå®šç•¶å‰çš„ AWS å€åŸŸã€‚</li>
<li><strong>å¾ç’°å¢ƒè®Šæ•¸ç²å–</strong>ï¼šéƒ¨ç½² Controller æ™‚å¯èƒ½è¨­ç½®äº† <code>AWS_REGION</code> æˆ– <code>AWS_DEFAULT_REGION</code> ç’°å¢ƒè®Šæ•¸ã€‚</li>
<li><strong>å¾ AWS SDK é…ç½®ç²å–</strong>ï¼šController ä½¿ç”¨ AWS SDKï¼Œå¯èƒ½æœƒå¾ <code>~/.aws/config</code> æˆ–å…¶ä»– AWS é…ç½®ä¾†æºç²å–å€åŸŸä¿¡æ¯ã€‚</li>
<li><strong>å¾ Controller çš„éƒ¨ç½²é…ç½®ç²å–</strong>ï¼šåœ¨ Helm chart æˆ– YAML éƒ¨ç½²æ–‡ä»¶ä¸­ï¼Œå¯èƒ½æœƒæ˜ç¢ºè¨­ç½® AWS å€åŸŸã€‚</li>
</ol>
<p>åŸºæœ¬åŸå‰‡æ˜¯ï¼šAWS Load Balancer Controller æœƒåœ¨éƒ¨ç½²å’Œé…ç½®æ™‚å·²ç¶“çŸ¥é“å®ƒæ‡‰è©²æ“ä½œå“ªå€‹ AWS å€åŸŸï¼Œé€™æ¨£ç•¶ä½ æ‡‰ç”¨ Ingress è³‡æºæ™‚ï¼Œå®ƒå°±å·²ç¶“çŸ¥é“æ‡‰è©²åœ¨å“ªå€‹å€åŸŸå‰µå»º ALBã€‚</p>
<p>é€™æ­£æ˜¯ Kubernetes é‹ç‡Ÿå•†æ¨¡å¼ï¼ˆOperator Patternï¼‰çš„é­…åŠ›æ‰€åœ¨ - ä½ åªéœ€è¦è²æ˜ä½ æƒ³è¦ä»€éº¼ï¼ˆåœ¨é€™å€‹ä¾‹å­ä¸­æ˜¯ä¸€å€‹ Ingress è³‡æºï¼‰ï¼Œè€Œå°ˆé–€çš„ Controller æœƒè™•ç†å¦‚ä½•åœ¨ç‰¹å®šçš„é›²ç’°å¢ƒä¸­å¯¦ç¾å®ƒçš„æ‰€æœ‰ç´°ç¯€ã€‚</p>
<h1 id="chatgpt-4o">ChatGPT 4o<a hidden class="anchor" aria-hidden="true" href="#chatgpt-4o">#</a></h1>
<p>åœ¨ Kubernetes (k8s) çš„ Ingress è¨­å®šä¸­ï¼Œä½ çš„ <code>ingress.yaml</code> ä¸¦ä¸æœƒç›´æ¥æŒ‡å®š AWS Regionï¼Œä½† Kubernetes ä¹‹æ‰€ä»¥çŸ¥é“è©²åœ¨å“ªå€‹ AWS Region å»ºç«‹ ALB (Application Load Balancer)ï¼Œæ˜¯å› ç‚º <strong>ä½ çš„ EKS Cluster (æˆ– Kubernetes cluster) æ˜¯å»ºç«‹åœ¨æŸå€‹ AWS Region ä¸Šçš„</strong>ã€‚</p>
<h3 id="ç‚ºä»€éº¼-kubernetes-çŸ¥é“è¦åœ¨å“ªå€‹-aws-region-å»ºç«‹-alb">ç‚ºä»€éº¼ Kubernetes çŸ¥é“è¦åœ¨å“ªå€‹ AWS Region å»ºç«‹ ALBï¼Ÿ<a hidden class="anchor" aria-hidden="true" href="#ç‚ºä»€éº¼-kubernetes-çŸ¥é“è¦åœ¨å“ªå€‹-aws-region-å»ºç«‹-alb">#</a></h3>
<ol>
<li><strong>EKS Cluster å·²ç¶“ç¶å®š AWS Region</strong>
<ul>
<li>
<p>ç•¶ä½ å»ºç«‹ EKS (Amazon Elastic Kubernetes Service) Cluster æ™‚ï¼Œä½ å·²ç¶“æŒ‡å®šäº† AWS Regionã€‚ä¾‹å¦‚ï¼š</p>
<pre tabindex="0"><code>aws eks create-cluster --region us-west-2 --name my-cluster ...
</code></pre></li>
<li>
<p>é€™å€‹ EKS Cluster å…§çš„æ‰€æœ‰ AWS ç›¸é—œè³‡æº (åƒæ˜¯ Load Balancer, EBS, IAM Policies) éƒ½æœƒåœ¨é€™å€‹ Region å…§å»ºç«‹ã€‚</p>
</li>
</ul>
</li>
<li><strong>Kubernetes é€é AWS Load Balancer Controller è‡ªå‹•æŸ¥è©¢ Region</strong>
<ul>
<li>ç•¶ä½ åœ¨ <code>kubectl apply -f ingress.yaml</code> æ™‚ï¼ŒEKS å…§éƒ¨çš„ <strong>AWS Load Balancer Controller</strong> æœƒè‡ªå‹•è§£æè©² Ingress è³‡è¨Šï¼Œç„¶å¾Œï¼š
<ol>
<li>æŸ¥è©¢è©² EKS Cluster æ‰€åœ¨çš„ AWS Region</li>
<li>åœ¨è©² Region è‡ªå‹•å»ºç«‹å°æ‡‰çš„ ALB</li>
</ol>
</li>
<li>ä½ å¯ä»¥é€é <code>kubectl get deployment -n kube-system aws-load-balancer-controller</code> ç¢ºèª AWS Load Balancer Controller æ˜¯å¦æœ‰é‹è¡Œã€‚</li>
</ul>
</li>
<li><strong>é€é EKS Cluster çš„ IAM Role ä¾†å­˜å– AWS è³‡æº</strong>
<ul>
<li>EKS Cluster æœƒä½¿ç”¨æŒ‡å®šçš„ IAM Roleï¼Œé€™å€‹ Role çš„æ¬Šé™é€šå¸¸å…è¨±å®ƒç®¡ç† ELB/ALBã€‚</li>
<li>ç•¶ Ingress Controller åµæ¸¬åˆ°æ–°çš„ Ingress è³‡æºæ™‚ï¼Œå®ƒæœƒä½¿ç”¨é€™å€‹ IAM Role ä¾†å‘¼å« AWS APIï¼Œåœ¨ EKS Cluster æ‰€åœ¨çš„ Region å»ºç«‹ ALBã€‚</li>
</ul>
</li>
</ol>
<h3 id="ä½ å¯ä»¥åœ¨å“ªè£¡çœ‹åˆ°-region-è¨­å®š">ä½ å¯ä»¥åœ¨å“ªè£¡çœ‹åˆ° Region è¨­å®šï¼Ÿ<a hidden class="anchor" aria-hidden="true" href="#ä½ å¯ä»¥åœ¨å“ªè£¡çœ‹åˆ°-region-è¨­å®š">#</a></h3>
<p>å¦‚æœä½ æƒ³ç¢ºèªä½ çš„ Kubernetes Cluster æ˜¯åœ¨å“ªå€‹ AWS Regionï¼Œå¯ä»¥ï¼š</p>
<pre tabindex="0"><code>aws eks describe-cluster --name my-cluster --query &#34;cluster.resourcesVpcConfig.clusterSecurityGroupId&#34; --region us-west-2
</code></pre><p>æˆ–ç›´æ¥æŸ¥è©¢ Cluster çš„ Regionï¼š</p>
<pre tabindex="0"><code>kubectl get nodes -o wide
</code></pre><p>ä½ æœƒçœ‹åˆ° Node (EC2) æ˜¯åœ¨å“ªå€‹ AWS å¯ç”¨å€ (AZ)ï¼Œä¹Ÿå¯ä»¥æ¨æ–·å‡º Regionã€‚</p>
<hr>
<h3 id="çµè«–">çµè«–<a hidden class="anchor" aria-hidden="true" href="#çµè«–">#</a></h3>
<p>ç•¶ä½  <code>kubectl apply -f ingress.yaml</code>ï¼ŒKubernetes ä¹‹æ‰€ä»¥çŸ¥é“ ALB è¦å»ºåœ¨å“ªå€‹ Regionï¼Œæ˜¯å› ç‚ºï¼š</p>
<ol>
<li><strong>EKS Cluster æœ¬èº«å·²ç¶“æ˜¯ Region-Specific</strong>ï¼Œæ‰€æœ‰ AWS è³‡æºéƒ½æœƒåœ¨é€™å€‹ Region å…§å»ºç«‹ã€‚</li>
<li><strong>AWS Load Balancer Controller æœƒè‡ªå‹•åµæ¸¬ EKS Cluster çš„ Regionï¼Œä¸¦åœ¨ç›¸æ‡‰çš„ Region å…§å»ºç«‹ ALBã€‚</strong></li>
<li><strong>EKS Cluster çš„ IAM Role å·²ç¶“æœ‰æ¬Šé™å­˜å–è©² Region å…§çš„ AWS è³‡æºï¼Œè®“ Controller å¯ä»¥é€é AWS API å»ºç«‹ ALBã€‚</strong></li>
</ol>
<p>ä½ ä¸éœ€è¦æ‰‹å‹•æŒ‡å®š Regionï¼Œå› ç‚º EKS Cluster æœ¬èº«å·²ç¶“æ±ºå®šäº†ä¸€åˆ‡ ğŸš€</p>
</li>
</ul>
<h2 id="å‰æƒ…æè¦">å‰æƒ…æè¦<a hidden class="anchor" aria-hidden="true" href="#å‰æƒ…æè¦">#</a></h2>
<p>å‰›ç¶“æ­·äº†ä¸€æ³¢è‹¦æµ· <a href="https://www.notion.so/resources-request-pod-1b9ea7e0d9d08068aec7df5f90a14fbf?pvs=21">è¸©å‘ç´€éŒ„ - æ›´æ–°äº† resources requestï¼Œç„¡æ³•èª¿åº¦ pod</a> <a href="https://www.notion.so/Karpenter-Pod-WorkerNode-AZ-Pod-Node-1b9ea7e0d9d080fdb166c32a09044301?pvs=21">Karpenter å’Œ Pod è¦æ€éº¼è¨­ç½®ï¼Œæ‰å¯ä»¥è®“ WorkerNode é–‹åœ¨ä¸åŒ AZï¼ŒPod é…åœ¨ä¸åŒ Node</a></p>
<p>æ¥ä¸‹ä¾†æˆ‘è¦ç”¨ ALB æš´éœ²æˆ‘çš„æ‡‰ç”¨å•¦</p>
<p>å…¶å¯¦ä¹‹å‰åœ¨åš <a href="https://www.notion.so/Workshop-Amazon-EKS-Workshop-Fundamental-1a1ea7e0d9d0805582acccbd4e3430c6?pvs=21">[Workshop] <strong>AmazonÂ EKSÂ Workshop - Fundamental</strong></a> æœ‰åšåˆ°ä¸€é»é»ï¼Œå¤§æ¦‚æœ‰å€‹åŸºæœ¬æ¦‚å¿µäº†ï¼Œä½†æ˜¯æˆ‘å¸Œæœ›æˆ‘è‡ªå·±èƒ½å¤ å»ç†è§£é€å¾¹é€™é‚Šçš„åŸç†æ·±å…¥ä¸€é»</p>
<h2 id="å®‰è£-aws-load-banlancer-controller-åˆ°é›†ç¾¤">å®‰è£ AWS Load Banlancer Controller åˆ°é›†ç¾¤<a hidden class="anchor" aria-hidden="true" href="#å®‰è£-aws-load-banlancer-controller-åˆ°é›†ç¾¤">#</a></h2>
<p>å–è‡ª Helm TL;DR:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>helm repo add eks https://aws.github.io/eks-charts
</span></span><span style="display:flex;"><span><span style="color:#75715e"># If using IAM Roles for service account install as follows -  NOTE: you need to specify both of the chart values `serviceAccount.create=false` and `serviceAccount.name=aws-load-balancer-controller`</span>
</span></span><span style="display:flex;"><span>helm install aws-load-balancer-controller eks/aws-load-balancer-controller --set clusterName<span style="color:#f92672">=</span>my-cluster -n kube-system --set serviceAccount.create<span style="color:#f92672">=</span>false --set serviceAccount.name<span style="color:#f92672">=</span>aws-load-balancer-controller
</span></span><span style="display:flex;"><span><span style="color:#75715e"># If not using IAM Roles for service account</span>
</span></span><span style="display:flex;"><span>helm install aws-load-balancer-controller eks/aws-load-balancer-controller --set clusterName<span style="color:#f92672">=</span>my-cluster -n kube-system
</span></span></code></pre></div><p>æˆ‘æ˜¯æ²’å®‰è£å•¦ï¼Œå› ç‚ºæˆ‘ç›®å‰æ‰€åœ¨ Cluster å·²ç¶“æœ‰å‰äººå®‰è£éäº†ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ kubectl get deploy -n kube-system | grep aws-load
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>aws-load-balancer-controller             2/2     <span style="color:#ae81ff">2</span>            <span style="color:#ae81ff">2</span>           2y152d
</span></span></code></pre></div><h2 id="å»ºç«‹-ingress">å»ºç«‹ Ingress<a hidden class="anchor" aria-hidden="true" href="#å»ºç«‹-ingress">#</a></h2>
<p>é€™é‚Šæˆ‘æœƒéœ€è¦å…ˆæ‹¿åˆ° Nginx çš„ Service name</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ kubectl get svc
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>NAME          TYPE        CLUSTER-IP       EXTERNAL-IP   PORT<span style="color:#f92672">(</span>S<span style="color:#f92672">)</span>          AGE
</span></span><span style="display:flex;"><span>shiun-nginx   ClusterIP   172.20.235.205   &lt;none&gt;        80/TCP,443/TCP   3d2h
</span></span></code></pre></div><p>ç„¶å¾Œä¾†æ’°å¯« <code>ingress.yaml</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">networking.k8s.io/v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Ingress</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">shiun-onboarding-alb</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">shiun-onboarding</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">annotations</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">alb.ingress.kubernetes.io/scheme</span>: <span style="color:#ae81ff">internet-facing</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">alb.ingress.kubernetes.io/target-type</span>: <span style="color:#ae81ff">ip</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">alb.ingress.kubernetes.io/healthcheck-path</span>: <span style="color:#ae81ff">/</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">ingressClassName</span>: <span style="color:#ae81ff">alb</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">rules</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">http</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">paths</span>:
</span></span><span style="display:flex;"><span>          - <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">pathType</span>: <span style="color:#ae81ff">Prefix</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">backend</span>:
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">service</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">name</span>: <span style="color:#ae81ff">shiun-nginx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">port</span>:
</span></span><span style="display:flex;"><span>                  <span style="color:#f92672">number</span>: <span style="color:#ae81ff">80</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>kubectl apply -f ingress.yaml
</span></span></code></pre></div><p>æ¥è‘—ä¸Šå»çœ‹ ALB Consoleï¼Œå°±æœƒçœ‹åˆ°ä»–æ­£åœ¨å‰µå»ºäº†ï¼š</p>
<p><img loading="lazy" src="image.png" alt="image.png"  />
</p>
<p>ç„¶å¾Œæ‹¿åˆ° ALB çš„ DNS Nameï¼Œçœ‹åˆ°ç•«é¢ï¼ï¼</p>
<p><img loading="lazy" src="image%201.png" alt="image.png"  />
</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://shiun.me/tags/aws/">AWS</a></li>
      <li><a href="https://shiun.me/tags/kubernetes/">Kubernetes</a></li>
    </ul>
<nav class="paginav">
  <a class="next" href="https://shiun.me/blog/what-is-the-purpose-of-last-applied-configuration-in-kubectl-apply/">
    <span class="title">Next Â»</span>
    <br>
    <span>Kubernetes å¸¸è¦‹å•é¡Œï¼škubectl apply çš„ Last applied configuration ç”¨é€”æ˜¯ä»€éº¼ï¼Ÿ</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share How to Expose Your ALB by EKS on x"
            href="https://x.com/intent/tweet/?text=How%20to%20Expose%20Your%20ALB%20by%20EKS&amp;url=https%3a%2f%2fshiun.me%2fblog%2fhow-to-expose-your-alb-by-eks%2f&amp;hashtags=AWS%2cKubernetes">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share How to Expose Your ALB by EKS on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fshiun.me%2fblog%2fhow-to-expose-your-alb-by-eks%2f&amp;title=How%20to%20Expose%20Your%20ALB%20by%20EKS&amp;summary=How%20to%20Expose%20Your%20ALB%20by%20EKS&amp;source=https%3a%2f%2fshiun.me%2fblog%2fhow-to-expose-your-alb-by-eks%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share How to Expose Your ALB by EKS on facebook"
            href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fshiun.me%2fblog%2fhow-to-expose-your-alb-by-eks%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share How to Expose Your ALB by EKS on telegram"
            href="https://telegram.me/share/url?text=How%20to%20Expose%20Your%20ALB%20by%20EKS&amp;url=https%3a%2f%2fshiun.me%2fblog%2fhow-to-expose-your-alb-by-eks%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
</ul>

  </footer><div class="disqus markdown"><div id="disqus_thread"></div>
<script>
  

  

  (function () {
    
    var d = document,
      s = d.createElement("script");
    s.src = "https://shiun-me.disqus.com/embed.js";
    s.setAttribute("data-timestamp", +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>
<noscript
  >Please enable JavaScript to view the
  <a href="https://disqus.com/?ref_noscript"
    >comments powered by Disqus.</a
  ></noscript
>
</div>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2025 <a href="https://shiun.me/">Shiun</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
